---
import BaseLayout from "../layouts/BaseLayout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import ProjectCard from "../components/ProjectCard.astro";

const filters = ["All", "Behavioral Science", "Data Analysis", "Research", "Web Dev"] as const;

const projects = [
  {
    title: "Psyber Nexus",
    description: "A research-backed platform exploring psychology, cybersecurity, operational resilience, and digital deception patterns.",
    tags: ["Behavior", "Resilience", "Threat Modeling", "UX"],
    category: "Web Dev",
    link: "https://www.psybernexus.com",
  },
  {
    title: "Inpatient Risk Assessment Model",
    description: "A structured framework for triaging behavioral risk factors and documenting protective indicators in high-acuity clinical settings.",
    tags: ["Risk", "Assessment", "Crisis Response", "Documentation"],
    category: "Behavioral Science",
    link: "/resume",
  },
  {
    title: "Market Trend Analysis Briefs",
    description: "A set of market research primers synthesizing official data sources and industry reports into client-ready insights.",
    tags: ["Research", "Synthesis", "Reporting", "Trends"],
    category: "Research",
    link: "/resume",
  },
  {
    title: "Portfolio Optimization Notes",
    description: "Quantitative notes and models for evaluating instruments, assessing risk, and supporting allocation decisions.",
    tags: ["Quant", "Risk", "Modeling", "Excel"],
    category: "Data Analysis",
    link: "/resume",
  },
  {
    title: "Clinical Group Skills Toolkit",
    description: "A facilitation toolkit for evidence-based CBT/DBT group delivery with consistent documentation and outcomes tracking.",
    tags: ["CBT/DBT", "Facilitation", "Teams", "Outcomes"],
    category: "Behavioral Science",
    link: "/resume",
  },
  {
    title: "Research Methods & Statistics Sandbox",
    description: "A focused set of analysis exercises demonstrating hypothesis testing, methodological integrity, and interpretation.",
    tags: ["Methods", "Statistics", "SPSS/R", "Integrity"],
    category: "Data Analysis",
    link: "/resume",
  },
];
---

<BaseLayout title="Projects â€“ James Gregory Walsh" description="Projects by James (J.) Gregory Walsh.">
  <Header slot="header" currentPath="/projects" />

  <section class="projects-page">
    <div class="container projects-inner">
      <header class="projects-hero fade-in">
        <h1 class="projects-title">Selected Work</h1>
        <p class="projects-subhead">Projects at the intersection of psychology, behavioral analysis, research methods, and data-informed decision support.</p>
      </header>

      <div class="projects-controls fade-in stagger-1" aria-label="Project controls">
        <div class="projects-filters" role="group" aria-label="Filter projects">
          {filters.map((f, idx) => (
            <button
              type="button"
              class={`filter-btn ${idx === 0 ? "is-active" : ""}`}
              data-filter={f}
              aria-pressed={idx === 0 ? "true" : "false"}
            >
              {f}
            </button>
          ))}
        </div>

        <div class="projects-view" role="group" aria-label="Layout">
          <button type="button" class="view-btn is-active" data-view="grid" aria-pressed="true" aria-label="Grid view">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="8" height="8" rx="1"></rect>
              <rect x="13" y="3" width="8" height="8" rx="1"></rect>
              <rect x="3" y="13" width="8" height="8" rx="1"></rect>
              <rect x="13" y="13" width="8" height="8" rx="1"></rect>
            </svg>
          </button>
          <button type="button" class="view-btn" data-view="list" aria-pressed="false" aria-label="List view">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="8" y1="6" x2="21" y2="6"></line>
              <line x1="8" y1="12" x2="21" y2="12"></line>
              <line x1="8" y1="18" x2="21" y2="18"></line>
              <circle cx="4" cy="6" r="1"></circle>
              <circle cx="4" cy="12" r="1"></circle>
              <circle cx="4" cy="18" r="1"></circle>
            </svg>
          </button>
        </div>
      </div>

      <div class="projects-grid fade-in stagger-2" id="projects-grid" aria-label="Project list">
        {projects.map((p) => (
          <div class="project-wrap" data-category={p.category}>
            <ProjectCard
              title={p.title}
              description={p.description}
              tags={p.tags}
              category={p.category}
              image={p.image}
              link={p.link}
            />
          </div>
        ))}
      </div>

      <script>
        import "../../src/scripts/projects.ts";
      </script>
    </div>
  </section>

  <Footer slot="footer" />
</BaseLayout>

<style>
  .projects-page {
    padding: calc(var(--header-height) + var(--space-16)) 0 var(--space-24);
  }

  .projects-inner {
    max-width: 1200px;
  }

  .projects-hero {
    max-width: 70ch;
    margin-bottom: var(--space-12);
  }

  .projects-title {
    font-family: var(--font-serif);
    font-size: var(--text-4xl);
    font-weight: 400;
    letter-spacing: -0.02em;
    line-height: 1.05;
    margin-bottom: var(--space-4);
  }

  .projects-subhead {
    font-size: var(--text-lg);
    line-height: 1.7;
    color: var(--ink-60);
  }

  .projects-controls {
    display: flex;
    flex-direction: column;
    gap: var(--space-6);
    margin-bottom: var(--space-12);
    padding: var(--space-6);
    border: 1px solid var(--ink-10);
    border-radius: 14px;
    background: rgba(255, 255, 255, 0.55);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  :global(.dark) .projects-controls {
    background: rgba(10, 10, 10, 0.55);
    border-color: var(--ink-20);
  }

  .projects-filters {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }

  .filter-btn {
    min-height: 40px;
    padding: var(--space-2) var(--space-4);
    border-radius: 9999px;
    border: 1px solid var(--ink-10);
    background: var(--pure-white);
    color: var(--ink-80);
    font-size: var(--text-sm);
    font-weight: 600;
    transition: background var(--duration-fast) var(--ease-out),
      border-color var(--duration-fast) var(--ease-out),
      transform var(--duration-fast) var(--ease-out);
  }

  :global(.dark) .filter-btn {
    background: rgba(255, 255, 255, 0.04);
    border-color: var(--ink-20);
  }

  .filter-btn:hover {
    border-color: rgba(0, 51, 160, 0.35);
    background: rgba(0, 51, 160, 0.06);
    transform: translateY(-1px);
  }

  .filter-btn.is-active {
    border-color: var(--cern-blue);
    background: rgba(0, 51, 160, 0.10);
    color: var(--ink);
  }

  :global(.dark) .filter-btn.is-active {
    color: var(--ink);
    background: rgba(51, 102, 204, 0.18);
  }

  .projects-view {
    display: flex;
    gap: var(--space-2);
    align-items: center;
  }

  .view-btn {
    width: 44px;
    height: 44px;
    border-radius: 12px;
    border: 1px solid var(--ink-10);
    background: var(--pure-white);
    color: var(--ink-60);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: background var(--duration-fast) var(--ease-out),
      border-color var(--duration-fast) var(--ease-out),
      transform var(--duration-fast) var(--ease-out),
      color var(--duration-fast) var(--ease-out);
  }

  :global(.dark) .view-btn {
    background: rgba(255, 255, 255, 0.04);
    border-color: var(--ink-20);
  }

  .view-btn:hover {
    border-color: rgba(0, 51, 160, 0.35);
    background: rgba(0, 51, 160, 0.06);
    color: var(--ink);
    transform: translateY(-1px);
  }

  .view-btn.is-active {
    border-color: var(--cern-blue);
    color: var(--cern-blue);
    background: rgba(0, 51, 160, 0.10);
  }

  :global(.dark) .view-btn.is-active {
    background: rgba(51, 102, 204, 0.18);
  }

  .projects-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-8);
  }

  @media (min-width: 768px) {
    .projects-controls {
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-8);
    }

    .projects-grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  @media (min-width: 1024px) {
    .projects-grid {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .projects-grid.view-list {
      grid-template-columns: 1fr;
    }
  }

  /* Filtering transitions */
  .project-wrap {
    transition: opacity var(--duration-normal) var(--ease-out),
      transform var(--duration-normal) var(--ease-out);
  }

  .project-wrap.is-hidden {
    opacity: 0;
    transform: translateY(8px);
    pointer-events: none;
    height: 0;
    margin: 0;
    overflow: hidden;
  }

  .projects-grid.is-filtering .project-wrap {
    opacity: 0.55;
  }
</style>